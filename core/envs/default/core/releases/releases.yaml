releases:
  cert-manager:
    labels:
      component: certificates
      group: cluster
    options:
      injectReloaderAnnotations: true
    namespace: cert-manager
    release:
      chart: ../releases/dist/releases/charts/cert-manager
      name: cert-manager
  chartmuseum:
    labels:
      component: chartmuseum
      group: devops
    namespace: chartmuseum
    release:
      chart: ../releases/dist/releases/charts/chartmuseum
      name: chartmuseum
  cluster-issuers:
    labels:
      component: certificates
      group: cluster
    namespace: cert-manager
    release:
      chart: ../releases/dist/releases/charts/raw
      name: cluster-issuers
  test-logging:
    labels:
      component: test
      group: test-logging
    namespace: test-logging
    release:
      chart: ../releases/dist/releases/charts/test-logging
      name: test-logging
  cluster-logging:
    labels:
      component: cluster
      group: logging
    namespace: logging
    release:
      chart: ../releases/dist/releases/charts/cluster-logging
      name: cluster-logging
  container-registry-cleaner:
    labels:
      component: registry
      group: cluster
    namespace: system-tools
    release:
      chart: ../releases/dist/releases/charts/container-registry-cleaner
      name: container-registry-cleaner
  container-registry-config:
    labels:
      component: registry
      group: cluster
    namespace: container-registry-operator
    release:
      chart: ../releases/dist/releases/charts/container-registry-config
      name: container-registry-config
  container-registry-operator:
    labels:
      component: registry
      group: cluster
    namespace: container-registry-operator
    release:
      chart: ../releases/dist/releases/charts/container-registry-operator
      name: container-registry-operator
  crossplane:
    labels:
      component: crossplane
      group: devops
    namespace: crossplane-system
    release:
      chart: ../releases/dist/releases/charts/crossplane
      name: crossplane
  crossplane-buckets:
    labels: {}
    namespace: crossplane-system
    release:
      chart: ../releases/dist/releases/charts/crossplane-buckets
      name: crossplane-buckets
  crossplane-provider:
    hooks:
      - args:
          - -c
          - |
            # !/bin/bash
            # Wait CRD installation for 60 seconds
            for (( i=0; i <= 60; i++ )); do
                conditionMet=$(kubectl wait --timeout 60s --for=condition=established crd/providers.pkg.crossplane.io)
                if  echo "${conditionMet}" | grep "condition met"; then
                    echo "Waited $i second. CRDs are up"
                    exit 0;
                else
                    echo "Waiting for CRDs to be up (attempt $i)"
                    sleep 1;
                fi;
            done;
            exit 1
        command: "bash"
        events: ["presync"]
        showlogs: true
    labels:
      component: crossplane
      group: devops
    namespace: crossplane-system
    release:
      chart: ../releases/dist/releases/charts/raw
      name: crossplane-provider
      needs:
        - crossplane-system/crossplane
      wait: true
  crossplane-provider-config:
    hooks:
      - args:
          - -c
          - |
            # !/bin/bash
            # Wait Provider installation for 60 seconds
            for (( i=0; i <= 60; i++ )); do
                conditionMet=$(kubectl get providers.pkg.crossplane.io 2>&1)
                echo $conditionMet
                if [[ $(echo "${conditionMet}" | grep "No resources found") ]]; then
                    echo "Waiting for providers to be healty (attempt $i)"
                    sleep 1;
                elif [[ $(echo "${conditionMet}" | grep -E "False|Unknown") ]]; then
                    echo "Waiting for providers to be healty (attempt $i)"
                    sleep 1;
                elif [[ $(echo "${conditionMet}" | grep -E "True") ]]; then
                    echo "Waited $i iterations. All providers are up."
                    exit 0;
                else
                    echo "Uknown status, waiting..."
                    sleep 1;
                fi;
            done;
            exit 1
        command: "bash"
        events: ["presync"]
        showlogs: true
    labels:
      component: crossplane
      group: devops
    namespace: crossplane-system
    release:
      chart: ../releases/dist/releases/charts/raw
      name: crossplane-provider-config
      needs:
        - crossplane-system/crossplane
        - crossplane-system/crossplane-provider
      wait: true
  eck-operator:
    labels:
      component: eck
      group: operators
    namespace: elastic-system
    release:
      chart: ../releases/dist/releases/charts/eck-operator
      name: eck-operator
  efk:
    labels:
      component: efk
      group: logging
    options:
      removeIngressClassAnnotation: true
    namespace: efk
    release:
      chart: ../releases/dist/releases/charts/efk
      name: efk
  estafette-gke-node-pool-shifter:
    labels:
      cloud: gke
      component: preemptible
      group: estafette
    options:
      injectReloaderAnnotations: true
    namespace: estafette
    release:
      chart: ../releases/dist/releases/charts/estafette-gke-node-pool-shifter
      name: estafette-gke-node-pool-shifter
  estafette-gke-preemptible-killer:
    labels:
      cloud: gke
      component: preemptible
      group: estafette
    options:
      injectReloaderAnnotations: true
    namespace: estafette
    release:
      chart: ../releases/dist/releases/charts/estafette-gke-preemptible-killer
      name: estafette-gke-preemptible-killer
  estafette-k8s-node-compactor:
    labels:
      cloud: gke
      component: preemptible
      group: estafette
    options:
      injectReloaderAnnotations: true
    namespace: estafette
    release:
      chart: ../releases/dist/releases/charts/estafette-k8s-node-compactor
      name: estafette-k8s-node-compactor
  estafette-vulnerability-scanner:
    labels:
      component: scanner
      group: estafette
    namespace: estafette
    release:
      chart: ../releases/dist/releases/charts/estafette-vulnerability-scanner
      name: estafette-vulnerability-scanner
  external-dns:
    labels:
      component: dns
      group: cluster
    options:
      injectReloaderAnnotations: true
    namespace: external-dns
    release:
      chart: ../releases/dist/releases/charts/external-dns
      name: external-dns
  external-secrets:
    labels:
      component: external-secrets
      group: cluster
    namespace: external-secrets
    release:
      chart: ../releases/dist/releases/charts/external-secrets
      name: external-secrets
  flux:
    labels:
      component: flux
      group: devops
    namespace: flux-system
    release:
      chart: ../releases/dist/releases/charts/flux
      name: flux
  flux-config:
    labels:
      component: flux
      group: devops
    namespace: flux-system
    release:
      chart: ../releases/dist/releases/charts/flux-config
      name: flux-config
  forecastle:
    labels:
      component: admin
      group: cluster
    options:
      applyDefaultLabelsOnIngress: true
    namespace: forecastle
    release:
      chart: ../releases/dist/releases/charts/forecastle
      name: forecastle
  imagecache:
    labels:
      component: registry
      group: cluster
    namespace: kube-fledged
    release:
      chart: ../releases/dist/releases/charts/imagecache
      name: imagecache
  ingress-access-operator:
    labels:
      component: ingress
      group: operators
    namespace: ingress-access-operator
    release:
      chart: ../releases/dist/releases/charts/n9-api
      name: ingress-access-operator
  istio-base:
    labels:
      component: base
      group: istio
    namespace: istio-system
    release:
      chart: ../releases/dist/releases/charts/istio-base
      name: istio-base
  istio-grafana:
    labels:
      component: grafana
      group: istio
    namespace: istio-system
    release:
      chart: ../releases/dist/releases/charts/istio-grafana
      name: istio-grafana
  istio-ingress-sidecar:
    labels:
      component: ingress
      group: istio
    namespace: nginx-istio-ingress
    release:
      chart: ../releases/dist/releases/charts/raw
      name: istio-ingress-sidecar
      wait: true
  istio-kiali:
    labels:
      component: kiali
      group: istio
    namespace: istio-system
    release:
      chart: ../releases/dist/releases/charts/istio-kiali
      name: istio-kiali
  istio-prometheus:
    labels:
      component: prometheus
      group: istio
    namespace: istio-system
    release:
      chart: ../releases/dist/releases/charts/istio-prometheus
      name: istio-prometheus
  istio-rules-external-services:
    labels:
      component: egress
      group: istio
    namespace: istio-system
    release:
      chart: ../releases/dist/releases/charts/istio-rules-external-services
      name: istio-rules-external-services
  istiod:
    labels:
      component: discovery
      group: istio
    namespace: istio-system
    release:
      chart: ../releases/dist/releases/charts/istio-discovery
      name: istiod
  keycloak:
    labels:
      component: keycloak
      group: auth
    namespace: keycloak
    release:
      chart: ../releases/dist/releases/charts/keycloak
      name: keycloak
  keycloak-dev:
    labels:
      component: keycloak
      group: auth
    namespace: keycloak
    release:
      chart: ../releases/dist/releases/charts/keycloak
      name: keycloak-dev
  kps:
    labels:
      component: kps
      group: monitoring
    options:
      injectReloaderAnnotations: true
    namespace: monitoring
    release:
      chart: ../releases/dist/releases/charts/kps
      name: kps
  kube-cleanup-operator:
    labels:
      component: cleanup
      group: operators
    namespace: kube-cleanup-operator
    release:
      chart: ../releases/dist/releases/charts/kube-cleanup-operator
      name: kube-cleanup-operator
  kube-downscaler:
    labels:
      component: scaling
      group: cluster
    namespace: kube-downscaler
    release:
      chart: ../releases/dist/releases/charts/kube-downscaler
      name: kube-downscaler
  kube-fledged:
    labels:
      component: registry
      group: cluster
    namespace: kube-fledged
    release:
      chart: ../releases/dist/releases/charts/kube-fledged
      name: kube-fledged
  kubernetes-dashboard:
    labels:
      component: admin
      group: cluster
    namespace: kubernetes-dashboard
    release:
      chart: ../releases/dist/releases/charts/kubernetes-dashboard
      name: kubernetes-dashboard
  logging-gcs:
    labels: {}
    namespace: crossplane-system
    release:
      chart: ../releases/dist/releases/charts/crossplane-buckets
      name: logging-gcs
  logging-operator:
    labels:
      component: logging
      group: operators
    namespace: logging-operator
    release:
      chart: ../releases/dist/releases/charts/logging-operator
      name: logging-operator
  logging-stack:
    labels:
      component: stack
      group: logging
    namespace: logging
    release:
      chart: ../releases/dist/releases/charts/logging-stack
      name: logging-stack
  metrics-server:
    labels:
      component: metrics
      group: cluster
    namespace: system-tools
    release:
      chart: ../releases/dist/releases/charts/metrics-server
      name: metrics-server
  minio-operator:
    labels:
      component: minio
      group: operators
    namespace: minio-operator
    release:
      chart: ../releases/dist/releases/charts/minio-operator
      name: minio-operator
  minio-tenants:
    labels:
      component: tenant
      group: minio
    namespace: minio
    release:
      chart: ../releases/dist/releases/charts/minio-tenants
      name: minio-tenants
  mongodb-operator:
    labels:
      component: mongodb
      group: operators
    namespace: mongodb-operator
    release:
      chart: ../releases/dist/releases/charts/mongodb-kubernetes-operator
      name: mongodb-operator
  nexus:
    labels:
      component: repository
      group: dev
    namespace: nexus
    release:
      chart: ../releases/dist/releases/charts/sonatype-nexus
      name: nexus
  nginx:
    labels:
      component: nginx
      group: test
    namespace: nginx
    release:
      chart: ../releases/dist/releases/charts/nginx
      name: nginx
  nginx-ingress-controller:
    labels:
      component: controller
      group: ingress
    namespace: nginx-ingress
    release:
      chart: ../releases/dist/releases/charts/nginx-ingress-controller
      name: nginx-ingress-controller
  nginx-istio-ingress-controller:
    extraReleaseValues:
      - ./values/nginx-ingress-controller.yaml.gotmpl
    labels:
      component: controller
      group: ingress
    options:
      injectReloaderAnnotations: true
    namespace: nginx-istio-ingress
    release:
      chart: ../releases/dist/releases/charts/nginx-ingress-controller
      name: nginx-istio-ingress-controller
  node-initializer:
    labels:
      component: init
      group: system
    namespace: node-initializer
    release:
      chart: ../releases/dist/releases/charts/node-initializer
      name: node-initializer
  patch-operator:
    labels:
      component: admin
      group: cluster
    namespace: patch-operator
    release:
      chart: ../releases/dist/releases/charts/patch-operator
      name: patch-operator
    strategicMergePatches:
      - apiVersion: admissionregistration.k8s.io/v1
        kind: MutatingWebhookConfiguration
        metadata:
          name: patch-operator-mutating-webhook-configuration
        webhooks:
          - admissionReviewVersions:
              - v1
            clientConfig:
              service:
                name: patch-operator-webhook-service
                namespace: patch-operator
                path: /mutate-redhatcop-redhat-io-v1alpha1-patch
            failurePolicy: Fail
            name: mpatch.kb.io
            rules:
              - apiGroups:
                  - redhatcop.redhat.io
                apiVersions:
                  - v1alpha1
                operations:
                  - CREATE
                resources:
                  - patches
              - apiGroups:
                  - ""
                apiVersions:
                  - apps/v1
                operations:
                  - CREATE
                resources:
                  - deployments
                  - statefulsets
                  - services
                  - ingresses
            sideEffects: None
  polaris:
    labels:
      component: admin
      group: cluster
    options:
      applyDefaultLabelsOnIngress: true
    namespace: polaris
    release:
      chart: ../releases/dist/releases/charts/polaris
      name: polaris
  predator:
    labels:
      component: predator
      group: dev
    namespace: predator
    release:
      chart: ../releases/dist/releases/charts/predator
      name: predator
  priority-class:
    labels:
      component: config
      group: system
    namespace: system-tools
    release:
      chart: ../releases/dist/releases/charts/priority-class
      name: priority-class
  rabbitmq-cluster:
    labels:
      component: cluster
      group: rabbitmq
    namespace: rabbitmq
    release:
      chart: ../releases/dist/releases/charts/rabbitmq-cluster
      name: rabbitmq-cluster
  rabbitmq-config:
    labels:
      component: config
      group: rabbitmq
    namespace: rabbitmq
    release:
      chart: ../releases/dist/releases/charts/rabbitmq-config
      name: rabbitmq-config
  rabbitmq-operators:
    hooks:
      - args: ["WARNING: Deleting validating webhook configuration for RabbitMQ Topology Operator. This should not be done, but it doesn't work without it for now."]
        command: "echo"
        events: ["postsync"]
        showlogs: true
      - args: ["delete", "validatingwebhookconfiguration", "rabbitmq-operators-rabbitmq-messaging-topology-operator-webhook"]
        command: "kubectl"
        events: ["postsync"]
        showlogs: true
    labels:
      component: rabbitmq
      group: operators
    namespace: rabbitmq-system
    release:
      chart: ../releases/dist/releases/charts/rabbitmq-cluster-operator
      name: rabbitmq-operators
  reloader:
    labels:
      component: tool
      group: cluster
    namespace: reloader
    release:
      chart: ../releases/dist/releases/charts/reloader
      name: reloader
  replicator:
    labels:
      component: tool
      group: cluster
    namespace: replicator
    release:
      chart: ../releases/dist/releases/charts/kubernetes-replicator
      name: replicator
  sealed-secrets:
    labels:
      component: secrets
      group: cluster
    namespace: sealed-secrets
    release:
      chart: ../releases/dist/releases/charts/sealed-secrets
      name: sealed-secrets
  secret-generator:
    labels:
      component: secret-generator
      group: cluster
    namespace: secret-generator
    release:
      chart: ../releases/dist/releases/charts/kubernetes-secret-generator
      name: secret-generator
  sloop:
    labels:
      component: events
      group: monitoring
    namespace: sloop
    release:
      chart: ../releases/dist/releases/charts/sloop
      name: sloop
  sloth:
    labels:
      component: sre
      group: monitoring
    namespace: sloth
    release:
      chart: ../releases/dist/releases/charts/sloth
      name: sloth
  sonarqube:
    labels:
      component: qa
      group: dev
    namespace: sonarqube
    release:
      chart: ../releases/dist/releases/charts/sonarqube
      name: sonarqube
  starboard-operator:
    labels:
      component: cvs
      group: security
    namespace: starboard-operator
    release:
      chart: ../releases/dist/releases/charts/starboard-operator
      name: starboard-operator
  system-config:
    labels:
      component: config
      group: system
    namespace: system-tools
    release:
      chart: ../releases/dist/releases/charts/raw
      name: system-config
  system-jobs:
    labels:
      component: config
      group: system
    namespace: system-tools
    release:
      chart: ../releases/dist/releases/charts/system-jobs
      name: system-jobs
  tekton:
    labels:
      component: tekton
      group: devops
    options:
      injectReloaderAnnotations: true
    namespace: tekton-pipelines
    release:
      chart: ../releases/dist/releases/charts/tekton
      name: tekton
  tekton-catalog:
    labels:
      component: tekton
      group: devops
    namespace: tekton-pipelines
    release:
      chart: ../releases/dist/releases/charts/tekton-catalog
      name: tekton-catalog
      needs:
        - tekton-pipelines/tekton
  tekton-logging:
    labels:
      component: tekton
      group: logging
    namespace: logging
    release:
      chart: ../releases/dist/releases/charts/tekton-logging
      name: tekton-logging
  velero:
    labels:
      component: backups
      group: cluster
    options:
      injectReloaderAnnotations: true
    namespace: velero
    release:
      chart: ../releases/dist/releases/charts/velero
      name: velero
    strategicMergePatches:
      - apiVersion: apps/v1
        kind: Deployment
        metadata:
          name: velero
          namespace: velero
        spec:
          template:
            spec:
              containers:
                - env:
                    - name: GOOGLE_APPLICATION_CREDENTIALS
                      value: /credentials/velero.json
                  name: velero
  visitor-groups:
    labels:
      component: visitors
      group: ingress
    namespace: ingress-access-operator
    release:
      chart: ../releases/dist/releases/charts/raw
      name: visitor-groups
  zeebe:
    labels:
      component: zeebe
      group: middleware
    namespace: zeebe
    release:
      chart: ../releases/dist/releases/charts/zeebe-cluster-helm
      name: zeebe
  zeebe-operate:
    labels:
      component: zeebe
      group: middleware
    namespace: zeebe
    release:
      chart: ../releases/dist/releases/charts/zeebe-operate-helm
      name: zeebe-operate

  keda:
    labels: {}
    release:
      chart: ../releases/dist/releases/charts/keda
      name: keda
    namespace: keda

  prometheus-adapter:
    labels: {}
    namespace: monitoring
    release:
      chart: ../releases/dist/releases/charts/prometheus-adapter
      name: prometheus-adapter

  chaos-mesh:
    labels: {}
    namespace: chaos-mesh
    options:
      applyDefaultLabelsOnIngress: true
      applyDefaultAnnotationsOnIngress: true
      injectReloaderAnnotations: true
    release:
      chart: ../releases/dist/releases/charts/chaos-mesh
      name: chaos-mesh
  mongodb-atlas-operator:
    labels:
      component: atlas
      group: operators
    namespace: mongodb-atlas-operator
    release:
      chart: ../releases/dist/releases/charts/mongodb-atlas-operator
      name: mongodb-atlas-operator
